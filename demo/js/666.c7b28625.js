"use strict";(self["webpackChunkretter_chess_client"]=self["webpackChunkretter_chess_client"]||[]).push([[666],{9264:(e,t,n)=>{n.d(t,{W:()=>i});var o,i,s=function(e,t,n,o){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function c(e){try{l(o.next(e))}catch(t){s(t)}}function a(e){try{l(o["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):i(e.value).then(c,a)}l((o=o.apply(e,t||[])).next())}))};(function(e){e["Black"]="black",e["White"]="white"})(o||(o={})),function(e){class t{constructor(e){this._obj=e}static getInstance(e,n){return s(this,void 0,void 0,(function*(){return new t(yield e.getCloudObject(Object.assign(Object.assign({},n),{classId:"User"})))}))}signUp(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"signUp",body:e})).then((e=>e.data))}))}signIn(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"signIn",body:e})).then((e=>e.data))}))}joinGame(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"joinGame",body:e})).then((e=>e.data))}))}leaveGame(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"leaveGame",body:e})).then((e=>e.data))}))}}e.User=t;class n{constructor(e){this._obj=e}static getInstance(e,t){return s(this,void 0,void 0,(function*(){return new n(yield e.getCloudObject(Object.assign(Object.assign({},t),{classId:"Game"})))}))}join(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"join",body:e})).then((e=>e.data))}))}play(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"play",body:e})).then((e=>e.data))}))}leave(e,t){return s(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},t),{method:"leave",body:e})).then((e=>e.data))}))}}e.Game=n}(i||(i={}))},7666:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_});var o=n(3673),i=n(8880);const s={id:"chessboard"};function c(e,t,n,c,a,l){const r=(0,o.up)("q-fab-action"),u=(0,o.up)("q-fab"),d=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(d,{class:"row items-center justify-evenly"},{default:(0,o.w5)((()=>[(0,o._)("div",s,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.chessboard,(n=>((0,o.wg)(),(0,o.iD)("div",(0,o.dG)({key:n.id,class:n.color},n,{onClick:t[0]||(t[0]=(...t)=>e.onSelect&&e.onSelect(...t))}),null,16)))),128))]),(0,o.Wm)(u,{color:"blue","text-color":"white",icon:"keyboard_arrow_left",direction:"left"},{default:(0,o.w5)((()=>[(0,o.Wm)(r,{color:"blue","text-color":"white",icon:"exit_to_app",onClick:e.onLeave,title:"Leave"},null,8,["onClick"]),(0,o.wy)((0,o.Wm)(r,{color:"blue","text-color":"white",icon:"download",onClick:e.onDrop,title:"Drop"},null,8,["onClick"]),[[i.F8,e.selected.value]])])),_:1})])),_:1})}var a=n(1959),l=n(9264),r=n(8825),u=n(9582);const d={P:"&#9817;",R:"&#9814;",B:"&#9815;",N:"&#9816;",Q:"&#9813;",K:"&#9812;",p:"&#9823;",r:"&#9820;",b:"&#9821;",n:"&#9822;",q:"&#9819;",k:"&#9818;"},h=["A","B","C","D","E","F","G","H"];function b(){const e=[];for(let t=8;t>0;t--){let n=t%2?"black":"white";for(let o=0;o<h.length;o++){const i=`${h[o]}${t}`;e.push({id:i,color:n}),n="white"===n?"black":"white"}}return e}const v=(0,o.aZ)({name:"Chessboard",props:["currentGameId","rio","userProfile"],setup(e){const t=(0,r.Z)(),n=(0,u.tv)();let i,s;t.loading.show();const c=e.currentGameId,v=(0,a.iH)(b()),f=(0,a.iH)({[c]:!1}),g=(0,a.iH)("");function j(e){for(let t=8;t>0;t--)for(let n=0;n<h.length;n++){const o=`${h[n]}${t}`,i=e.pieces[o],s=i?d[i]:"&nbsp;",c=document.getElementById(o);c&&(c.innerHTML=s)}}return e.userProfile.online||n.push("/sign-in"),(0,o.bv)((()=>{const o=e.currentGameId;l.W.Game.getInstance(e.rio,{classId:"Game",instanceId:e.currentGameId}).then((e=>{var n;i=e,null===(n=e._obj.state)||void 0===n||n.public.subscribe((e=>{s=e,j(e.board),f.value[o]=!0,t.loading.hide()}))})).catch((e=>{console.log(e),n.push("/")}))})),(0,o.Ah)((()=>{const t=e.currentGameId;f.value[t]=!1})),{chessboard:v,games:f,selected:g,onSelect(t){const n=s.board.turn;if(e.userProfile.uid===s[n]){const e=t.srcElement;if(g.value){const t=document.getElementById(g.value);t&&i&&i.play({from:g.value,to:e.id}).then((()=>{t.classList.remove("selectedPiece"),g.value=""})).catch((e=>{console.log(e),t.classList.remove("selectedPiece"),g.value=""}))}else e.classList.add("selectedPiece"),g.value=e.id}else g.value=""},onLeave(){i&&i.leave()},onDrop(){g.value=""}}}});var f=n(4260),g=n(4379),j=n(9200),m=n(9975),p=n(7518),w=n.n(p);const y=(0,f.Z)(v,[["render",c]]),_=y;w()(v,"components",{QPage:g.Z,QFab:j.Z,QFabAction:m.Z})}}]);