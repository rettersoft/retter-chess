"use strict";(self["webpackChunkretter_chess_client"]=self["webpackChunkretter_chess_client"]||[]).push([[152],{9264:(e,a,t)=>{t.d(a,{W:()=>n});var l,n,o=function(e,a,t,l){function n(e){return e instanceof t?e:new t((function(a){a(e)}))}return new(t||(t=Promise))((function(t,o){function i(e){try{r(l.next(e))}catch(a){o(a)}}function u(e){try{r(l["throw"](e))}catch(a){o(a)}}function r(e){e.done?t(e.value):n(e.value).then(i,u)}r((l=l.apply(e,a||[])).next())}))};(function(e){e["Black"]="black",e["White"]="white"})(l||(l={})),function(e){class a{constructor(e){this._obj=e}static getInstance(e,t){return o(this,void 0,void 0,(function*(){return new a(yield e.getCloudObject(Object.assign(Object.assign({},t),{classId:"User"})))}))}signUp(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"signUp",body:e})).then((e=>e.data))}))}signIn(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"signIn",body:e})).then((e=>e.data))}))}joinGame(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"joinGame",body:e})).then((e=>e.data))}))}leaveGame(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"leaveGame",body:e})).then((e=>e.data))}))}}e.User=a;class t{constructor(e){this._obj=e}static getInstance(e,a){return o(this,void 0,void 0,(function*(){return new t(yield e.getCloudObject(Object.assign(Object.assign({},a),{classId:"Game"})))}))}join(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"join",body:e})).then((e=>e.data))}))}play(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"play",body:e})).then((e=>e.data))}))}leave(e,a){return o(this,void 0,void 0,(function*(){return this._obj.call(Object.assign(Object.assign({},a),{method:"leave",body:e})).then((e=>e.data))}))}}e.Game=t}(n||(n={}))},9152:(e,a,t)=>{t.r(a),t.d(a,{default:()=>ee});var l=t(3673),n=t(8880),o=t(2323);const i=(0,l.Uk)(" Retter Chess "),u=(0,l.Uk)(" Create A New Game "),r=(0,l.Uk)(" Join A Game "),m=(0,l.Uk)(" Create A New Game "),s=(0,l.Uk)(" Join A Game "),d=(0,l._)("div",{class:"text-h6"},"Pick Your Side",-1),c=(0,l._)("div",{class:"text-h6"},"Join An Existing Game",-1),p=(0,l._)("span",{class:"q-ml-sm"},"Do you really want to sign out?",-1),w=(0,l._)("span",{class:"q-ml-sm"},"Do you really want to play this game?",-1);function f(e,a,t,f,g,h){const _=(0,l.up)("q-btn"),v=(0,l.up)("q-toolbar-title"),b=(0,l.up)("q-toolbar"),W=(0,l.up)("q-header"),y=(0,l.up)("q-item-label"),k=(0,l.up)("q-icon"),G=(0,l.up)("q-item-section"),j=(0,l.up)("q-item"),I=(0,l.up)("q-separator"),C=(0,l.up)("game-list"),O=(0,l.up)("q-list"),Z=(0,l.up)("q-drawer"),q=(0,l.up)("q-card-section"),Q=(0,l.up)("q-radio"),S=(0,l.up)("q-card-actions"),U=(0,l.up)("q-card"),V=(0,l.up)("q-dialog"),H=(0,l.up)("q-input"),D=(0,l.up)("q-avatar"),L=(0,l.up)("router-view"),P=(0,l.up)("q-page-container"),x=(0,l.up)("q-layout"),N=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)(x,{view:"lHh Lpr lFf"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{elevated:""},{default:(0,l.w5)((()=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(_,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:e.toggleLeftDrawer},null,8,["onClick"]),[[n.F8,e.userProfile.online]]),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[i])),_:1}),(0,l.Wm)(_,{flat:"",round:"",dense:"",icon:"link",title:"retter.io",onClick:a[0]||(a[0]=a=>e.openLink("https://retter.io"))}),(0,l.wy)((0,l.Wm)(_,{flat:"",round:"",dense:"",icon:"exit_to_app",title:"Sign Out",onClick:a[1]||(a[1]=a=>e.confirmSignOut=!0)},null,512),[[n.F8,e.userProfile.online]])])),_:1})])),_:1}),(0,l.Wm)(Z,{modelValue:e.leftDrawerOpen,"onUpdate:modelValue":a[6]||(a[6]=a=>e.leftDrawerOpen=a),bordered:""},{default:(0,l.w5)((()=>[e.gameList.length?((0,l.wg)(),(0,l.j4)(O,{key:0},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{header:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.userProfile.name),1)])),_:1}),(0,l.wy)((0,l.Wm)(j,{clickable:"",onClick:a[2]||(a[2]=a=>e.promptCreateNewGame=!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{name:"add_circle_outline"})])),_:1}),(0,l.Wm)(G,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[u])),_:1})])),_:1})])),_:1},512),[[n.F8,e.btnGame]]),(0,l.wy)((0,l.Wm)(j,{clickable:"",onClick:a[3]||(a[3]=a=>e.promptJoinGame=!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{name:"add_circle_outline"})])),_:1}),(0,l.Wm)(G,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[r])),_:1})])),_:1})])),_:1},512),[[n.F8,e.btnGame]]),(0,l.Wm)(I),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.gameList,(a=>((0,l.wg)(),(0,l.j4)(C,(0,l.dG)({key:a.title},a,{onChangeGame:e.playGame}),null,16,["onChangeGame"])))),128))])),_:1})):((0,l.wg)(),(0,l.j4)(O,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{header:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.userProfile.name),1)])),_:1}),(0,l.wy)((0,l.Wm)(j,{clickable:"",onClick:a[4]||(a[4]=a=>e.promptCreateNewGame=!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{name:"add_circle_outline"})])),_:1}),(0,l.Wm)(G,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[m])),_:1})])),_:1})])),_:1},512),[[n.F8,e.btnGame]]),(0,l.wy)((0,l.Wm)(j,{clickable:"",onClick:a[5]||(a[5]=a=>e.promptJoinGame=!0)},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{name:"add_circle_outline"})])),_:1}),(0,l.Wm)(G,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[s])),_:1})])),_:1})])),_:1},512),[[n.F8,e.btnGame]])])),_:1}))])),_:1},8,["modelValue"]),(0,l.Wm)(P,null,{default:(0,l.w5)((()=>[(0,l.Wm)(V,{modelValue:e.promptCreateNewGame,"onUpdate:modelValue":a[9]||(a[9]=a=>e.promptCreateNewGame=a),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{style:{"min-width":"350px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(q,null,{default:(0,l.w5)((()=>[d])),_:1}),(0,l.Wm)(q,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(Q,{modelValue:e.pickedSide,"onUpdate:modelValue":a[7]||(a[7]=a=>e.pickedSide=a),"checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"white",label:"White"},null,8,["modelValue"]),(0,l.Wm)(Q,{modelValue:e.pickedSide,"onUpdate:modelValue":a[8]||(a[8]=a=>e.pickedSide=a),"checked-icon":"task_alt","unchecked-icon":"panorama_fish_eye",val:"black",label:"Black"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(S,{align:"right",class:"text-primary"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Cancel",color:"secondary"},null,512),[[N]]),(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Create",color:"primary",onClick:e.createGame},null,8,["onClick"]),[[N]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(V,{modelValue:e.promptJoinGame,"onUpdate:modelValue":a[11]||(a[11]=a=>e.promptJoinGame=a),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,{style:{"min-width":"350px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(q,null,{default:(0,l.w5)((()=>[c])),_:1}),(0,l.Wm)(q,{class:"q-pt-none"},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{modelValue:e.joinGameId,"onUpdate:modelValue":a[10]||(a[10]=a=>e.joinGameId=a),label:"Game Id","lazy-rules":"",rules:[e=>e&&e.length>0||"Please type the game ID"]},null,8,["modelValue","rules"])])),_:1}),(0,l.Wm)(S,{align:"right",class:"text-primary"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Cancel",color:"secondary"},null,512),[[N]]),(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Join",color:"primary",onClick:e.joinGame},null,8,["onClick"]),[[N]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(V,{modelValue:e.confirmSignOut,"onUpdate:modelValue":a[12]||(a[12]=a=>e.confirmSignOut=a),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(q,{class:"row items-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{icon:"exit_to_app",color:"primary","text-color":"white"}),p])),_:1}),(0,l.Wm)(S,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Cancel",color:"secondary"},null,512),[[N]]),(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Sign Out",color:"primary",onClick:e.signOut},null,8,["onClick"]),[[N]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(V,{modelValue:e.confirmChangeGame,"onUpdate:modelValue":a[14]||(a[14]=a=>e.confirmChangeGame=a),persistent:""},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(q,{class:"row items-center"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{icon:"play_circle_outline",color:"primary","text-color":"white"}),w])),_:1}),(0,l.Wm)(S,{align:"right"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Cancel",color:"secondary"},null,512),[[N]]),(0,l.wy)((0,l.Wm)(_,{flat:"",label:"Play",color:"primary",onClick:a[13]||(a[13]=a=>e.playGame(e.selectedGameId,!0))},null,512),[[N]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,l.Wm)(L,{currentGameId:e.currentGameId,rio:e.rio,userProfile:e.userProfile,onCustomToken:e.customToken},null,8,["currentGameId","rio","userProfile","onCustomToken"])])),_:1})])),_:1})}function g(e,a,t,n,i,u){const r=(0,l.up)("q-icon"),m=(0,l.up)("q-item-section"),s=(0,l.up)("q-item-label"),d=(0,l.up)("q-item");return(0,l.wg)(),(0,l.j4)(d,{clickable:"",onClick:a[0]||(a[0]=a=>e.$emit("change-game",e.gameId))},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{name:"play_circle_outline"})])),_:1}),(0,l.Wm)(m,null,{default:(0,l.w5)((()=>[(0,l.Wm)(s,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" #"+(0,o.zw)(e.gameId)+" ",1),(0,l._)("small",null,"("+(0,o.zw)(e.side)+")",1)])),_:1}),(0,l.Wm)(s,{caption:""},{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(e.formatDate(new Date(e.createdAt))),1)])),_:1})])),_:1})])),_:1})}var h=t(8792);const _=(0,l.aZ)({name:"GameList",props:["gameId","side","createdAt"],setup(){return{formatDate(e){return(0,h.Z)(e,"dd.MM.yyyy HH:mm")}}}});var v=t(4260),b=t(3414),W=t(2035),y=t(4554),k=t(2350),G=t(7518),j=t.n(G);const I=(0,v.Z)(_,[["render",g]]),C=I;j()(_,"components",{QItem:b.Z,QItemSection:W.Z,QIcon:y.Z,QItemLabel:k.Z});var O=t(8922),Z=t.n(O),q=t(1959),Q=t(9264),S=t(8825),U=t(9582);function V(e,a){return a.find((a=>!e.find((e=>e.gameId===a.gameId))))}const H=(0,l.aZ)({name:"MainLayout",components:{GameList:C},setup(){let e;const a=(0,S.Z)(),t=(0,U.tv)();a.loading.show();const l=(0,q.iH)(!1),n=(0,q.iH)(!1),o=(0,q.iH)(!1),i=(0,q.iH)(!1),u=(0,q.iH)(!1),r=(0,q.iH)("white"),m=(0,q.iH)(!1),s=(0,q.iH)(""),d=(0,q.iH)([]),c=(0,q.iH)(""),p=(0,q.iH)(""),w=(0,q.iH)({online:!1,anonymous:!1,name:"Loading...",uid:""}),f=(0,q.iH)(Z().getInstance({projectId:"u086mstg2",region:O.RetterRegion.euWest1}));return f.value.authStatus.subscribe((l=>{console.log(l),"SIGNED_OUT"===l.authStatus?(w.value.anonymous=!0,w.value.online=!1,o.value=!1,e=void 0,t.push("/sign-in")):"SIGNED_IN"===l.authStatus?(w.value.anonymous=!1,w.value.uid=l.uid,t.push("/"),e||(a.loading.show(),Q.W.User.getInstance(f.value,{classId:"User",instanceId:l.uid}).then((l=>{var n;e=l,null===(n=l._obj.state)||void 0===n||n.public.subscribe((e=>{var l;console.log(JSON.stringify(e)),w.value=Object.assign(w.value,{name:e.name}),c.value||(c.value=null===(l=V(d.value,e.games))||void 0===l?void 0:l.gameId,c.value&&t.push("/game")),d.value=e.games,i.value=!0,w.value.online=!0,o.value=!0,a.loading.hide()}))})).catch((e=>{console.log(e),f.value.signOut()})))):l.authStatus.startsWith("SIGNED_IN")&&(w.value.anonymous||(w.value.anonymous=!0,w.value.online=!1,o.value=!1,e=void 0,t.push("/sign-in")))})),{pickedSide:r,joinGameId:s,gameList:d,confirmSignOut:l,leftDrawerOpen:o,userProfile:w,btnGame:i,promptCreateNewGame:u,promptJoinGame:m,confirmChangeGame:n,selectedGameId:p,currentGameId:c,rio:f,toggleLeftDrawer(){o.value=!o.value},openLink(e){window.open(e,"_blank")},customToken(e){f.value.authenticateWithCustomToken(e)},createGame(){a.loading.show(),Q.W.Game.getInstance(f.value,{classId:"Game",body:{side:r.value}})},joinGame(){a.loading.show(),Q.W.Game.getInstance(f.value,{classId:"Game",instanceId:s.value}).then((e=>e.join()))},playGame(e,l){e!==c.value&&(l?(a.loading.show(),c.value=p.value,t.push("/game")):(n.value=!0,p.value=e))},signOut(){a.loading.show(),f.value.signOut()}}}});var D=t(3066),L=t(3812),P=t(9570),x=t(6114),N=t(3747),J=t(5400),A=t(7011),T=t(5869),F=t(2652),z=t(3379),E=t(151),M=t(5589),R=t(9337),B=t(9367),Y=t(3037),K=t(5096),$=t(677);const X=(0,v.Z)(H,[["render",f]]),ee=X;j()(H,"components",{QLayout:D.Z,QHeader:L.Z,QToolbar:P.Z,QBtn:x.Z,QToolbarTitle:N.Z,QDrawer:J.Z,QList:A.Z,QItemLabel:k.Z,QItem:b.Z,QItemSection:W.Z,QIcon:y.Z,QSeparator:T.Z,QPageContainer:F.Z,QDialog:z.Z,QCard:E.Z,QCardSection:M.Z,QRadio:R.Z,QCardActions:B.Z,QInput:Y.Z,QAvatar:K.Z}),j()(H,"directives",{ClosePopup:$.Z})}}]);